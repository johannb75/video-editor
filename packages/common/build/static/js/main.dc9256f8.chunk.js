(this["webpackJsonp@video-editor/web"]=this["webpackJsonp@video-editor/web"]||[]).push([[0],{215:function(e,t){},216:function(e,t){},217:function(e,t){},219:function(e,t){},220:function(e,t){},221:function(e,t){},222:function(e,t,n){"use strict";n.r(t);var r,c,i=n(0),o=n.n(i),a=n(85),u=n.n(a),l=(n(96),n(6)),s=n(3),d=n(5);!function(e){e[e.NORMAL=0]="NORMAL",e[e.NEON=1]="NEON"}(r||(r={})),function(e){e[e.INITIAL=0]="INITIAL",e[e.TEXT=1]="TEXT",e[e.DRAW=2]="DRAW",e[e.IMAGE_UPLOAD=3]="IMAGE_UPLOAD",e[e.DUO_UPLOAD=4]="DUO_UPLOAD",e[e.SOUND_CHANGE=5]="SOUND_CHANGE",e[e.VIDEO_TRIM=6]="VIDEO_TRIM",e[e.AUDIO_TRIM=7]="AUDIO_TRIM"}(c||(c={}));var f=Object(l.b)({key:"scriptState",default:{}}),b=Object(l.b)({key:"pageState",default:c.INITIAL}),j=Object(l.b)({key:"variablesState",default:{FPS:30,videoDuration:11.863,playVideo:!1,currentFrame:void 0,isDrawing:!1,erasing:!1}}),O=(Object(l.b)({key:"textOptionsState",default:{color:"#FFFFFF",background:"#272A2BDE",fontFamily:"Arial",fontWeight:500,fontStyle:"normal",textAlign:"center"}}),Object(l.b)({key:"lineOptionsState",default:{color:"#FFFFFF",size:12,type:r.NORMAL}})),h=n(91),v=["#ffffff","#000000","#f44336","#e91e63","#9c27b0","#673ab7","#3f51b5","#2196f3","#03a9f4","#00bcd4","#009688","#4caf50","#8bc34a","#cddc39","#ffeb3b","#ffc107","#ff9800","#ff5722","#795548","#607d8b"],g=n(4),x=function(e){e.canvasRef;var t=Object(l.e)(b),n=Object(l.c)(j),r=Object(d.a)(n,2),o=(r[0],r[1]),a=Object(l.c)(O),u=Object(d.a)(a,2),f=u[0],x=u[1];return Object(i.useEffect)((function(){o((function(e){return Object(s.a)(Object(s.a)({},e),{},{isDrawing:!0})}))}),[]),Object(g.jsxs)("div",{children:[Object(g.jsx)("button",{onClick:function(){return o((function(e){return Object(s.a)(Object(s.a)({},e),{},{isDrawing:!1})})),t(c.INITIAL)},children:"Exit"}),Object(g.jsx)("button",{onClick:function(){return o((function(e){return Object(s.a)(Object(s.a)({},e),{},{erasing:!0})}))},children:"Erasing"}),Object(g.jsx)("button",{onClick:function(){return o((function(e){return Object(s.a)(Object(s.a)({},e),{},{erasing:!1})}))},children:"Draw"}),Object(g.jsx)("input",{type:"number",value:f.size,onChange:function(e){return x((function(t){return Object(s.a)(Object(s.a)({},t),{},{size:e.currentTarget.valueAsNumber})}))}}),Object(g.jsx)(h.a,{width:"100%",circleSize:22,circleSpacing:10,colors:v,color:f.color,onChangeComplete:function(e){var t=e.hex;return x((function(e){return Object(s.a)(Object(s.a)({},e),{},{color:t})}))}})]})},p=function(e){var t,n,r,i=e.canvasRef,o=e.videoRef,a=Object(l.e)(b),u=Object(l.c)(j),f=Object(d.a)(u,2),O=f[0],h=f[1];return Object(g.jsxs)("div",{children:[Object(g.jsx)("button",{onClick:function(){return a(c.DRAW)},children:"Draw"}),Object(g.jsx)("button",{onClick:function(){if(!i.current)return console.log("canvas not initialized");var e=i.current.addText("");return h((function(t){return Object(s.a)(Object(s.a)({},t),{},{textId:e})})),a(c.TEXT)},children:"Text"}),Object(g.jsx)("button",{onClick:null===(t=i.current)||void 0===t?void 0:t.clear,children:"Clear All"}),Object(g.jsx)("button",{onClick:null===(n=i.current)||void 0===n?void 0:n.undo,children:"Undo"}),Object(g.jsx)("button",{onClick:null===(r=i.current)||void 0===r?void 0:r.redo,children:"Redo"}),Object(g.jsx)("button",{onClick:function(){var e,t;return console.log(null===(e=i.current)||void 0===e||null===(t=e.getFabric())||void 0===t?void 0:t.toObject(["id"]).objects)},children:"To JSON"}),O.playVideo&&!O.currentFrame?Object(g.jsx)("button",{onClick:function(){return h((function(e){var t,n;return Object(s.a)(Object(s.a)({},e),{},{playVideo:!1,currentFrame:null!==(t=Math.round(null===(n=o.current)||void 0===n?void 0:n.currentTime)*e.FPS)&&void 0!==t?t:1})}))},children:"Pin frame"}):Object(g.jsx)("button",{onClick:function(){return h((function(e){return Object(s.a)(Object(s.a)({},e),{},{playVideo:!0,currentFrame:void 0})}))},children:"Unpin frame"})]})},w=function(e){var t=e.canvasRef,n=Object(l.e)(b),r=Object(l.d)(j).selectedTextId,o=Object(i.useState)(""),a=Object(d.a)(o,2),u=(a[0],a[1]),s=Object(i.useRef)(),f=function(){n(c.INITIAL)};if(!r||!t.current)return f(),Object(g.jsx)(g.Fragment,{children:"Redirecting..."});return Object(g.jsxs)("div",{children:[Object(g.jsx)("button",{onClick:f,children:"Exit"}),Object(g.jsx)("textarea",{placeholder:"Text goes here ...",onChange:function(e){var t=e.currentTarget.value.trim();return u(t),function(e){s.current.text=e.trim()}(t)}}),Object(g.jsx)("input",{type:"color",onChange:function(e){return s.current.fill=e.currentTarget.value,e.currentTarget.value}})]})},C=n(17),D=n(225),I=n(57),T=(n(218),n(58)),m=n(10),A=m.fabric.util.createClass(m.fabric.Group,{original:null,erasedPath:null,initialize:function(e,t,n,r){this.original=e,this.erasedPath=t,this.callSuper("initialize",[this.original,this.erasedPath],n,r)},_calcBounds:function(e){var t=[],n=[],r=["tr","br","bl","tl"],c=r.length,i=this.original;i.setCoords(!0);for(var o=0;o<c;o++)t.push(i.oCoords[r[o]].x),n.push(i.oCoords[r[o]].y);this._getBounds(t,n,e)}}),R=m.fabric.util.createClass(m.fabric.PencilBrush,{_finalizeAndAddPath:function(){var e=this;this.canvas.contextTop.closePath(),this.decimate&&(this._points=this.decimatePoints(this._points,this.decimate));var t=this.convertPointsToSVGPath(this._points).join("");if("M 0 0 Q 0 0 0 0 L 0 0"!==t){var n=this.createPath(t);n.globalCompositeOperation="destination-out",n.selectable=!1,n.evented=!1,n.absolutePositioned=!0;var r=this.canvas.getObjects().filter((function(e){return!!e.intersectsWithObject(n)}));if(r.length>0){var c=new m.fabric.Group(r),i=new A(c,n),o=i.left,a=i.top,u=i.toDataURL({withoutTransform:!0});m.fabric.Image.fromURL(u,(function(t){var n;t.set({left:o,top:a}),(n=e.canvas).remove.apply(n,Object(C.a)(r)),e.canvas.add(t)}))}this.canvas.clearContext(this.canvas.contextTop),this.canvas.renderAll(),this._resetShadow()}else this.canvas.requestRenderAll()}}),F=o.a.forwardRef((function(e,t){e.onTextDoubleClick;var n=Object(l.d)(O),r=Object(l.c)(f),c=Object(d.a)(r,2),o=(c[0],c[1]),a=Object(l.d)(j),u=Object(i.useRef)(),b=Object(i.useRef)(null),h=Object(i.useRef)(),v=function(){var e=window.innerWidth,t=window.innerHeight;b.current&&h.current&&(b.current.width=window.innerWidth,b.current.height=window.innerHeight,h.current.setWidth(e),h.current.setHeight(t),h.current.calcOffset())};return Object(i.useImperativeHandle)(t,(function(){return{clear:function(){var e;return null===(e=h.current)||void 0===e?void 0:e.clear()},undo:function(){var e,t;return null===(e=h.current)||void 0===e||null===(t=e.undo)||void 0===t?void 0:t.call(e)},redo:function(){var e,t;return null===(e=h.current)||void 0===e||null===(t=e.redo)||void 0===t?void 0:t.call(e)},addText:function(e){var t,n=Object(D.a)(),r=new I.fabric.IText(e,{id:n,textAlign:"center",fill:"black",textBackgroundColor:"white",fontWeight:700,fontFamily:"Arial"});return null===(t=h.current)||void 0===t||t.add(r),r.center(),n},getObject:function(e){for(var t,n,r=null!==(t=null===(n=h.current)||void 0===n?void 0:n.getObjects())&&void 0!==t?t:[],c=0;c<r.length;c++){var i=r[c];if((null===i||void 0===i?void 0:i.id)===e)return i}},getFabric:function(){return h.current},getCanvas:function(){return b.current}}})),Object(i.useEffect)((function(){u.current=a.currentFrame}),[a.currentFrame]),Object(i.useEffect)((function(){h.current&&(h.current.isDrawingMode=a.isDrawing)}),[a.isDrawing]),Object(i.useEffect)((function(){h.current&&(a.erasing?(h.current.freeDrawingBrush=new R(h.current),h.current.freeDrawingBrush.color="#FF0000",h.current.freeDrawingBrush.width=20):(h.current.freeDrawingBrush=new T.PSBrush(h.current),h.current.freeDrawingBrush.color=n.color,h.current.freeDrawingBrush.width=n.size,h.current.freeDrawingBrush.globalCompositeOperation="destination-over"))}),[a.erasing]),Object(i.useEffect)((function(){h.current&&n.color&&!a.erasing&&(h.current.freeDrawingBrush.color=n.color)}),[n.color]),Object(i.useEffect)((function(){h.current&&n.size&&(h.current.freeDrawingBrush.width=n.size)}),[n.size]),Object(i.useEffect)((function(){var e=h.current=new I.fabric.Canvas(b.current),t=new T.PSBrush(e);return t.color=n.color,t.width=n.size,e.freeDrawingBrush=t,v(),window.addEventListener("resize",v,!1),e.on("object:added",(function(e){var t=Object(D.a)();o((function(e){var n,r,c=null!==(n=u.current)&&void 0!==n?n:1,i=Object(s.a)({},e),o=i[c];return i[c]=Object(s.a)(Object(s.a)({},o),{},{show:[].concat(Object(C.a)(null!==(r=null===o||void 0===o?void 0:o.show)&&void 0!==r?r:[]),[t])}),i})),e.path?(e.path.id=t,e.path.hasControls=!1):e.target&&(e.target.id=t,e.target.hasControls=!1)})),function(){window.removeEventListener("resize",v,!1)}}),[]),Object(g.jsx)("div",{style:{width:"100%",height:"100%",position:"absolute",zIndex:2},children:Object(g.jsx)("canvas",{ref:b})})}));F.displayName="EditCanvas";var E=F,y=o.a.forwardRef((function(e,t){var n=Object(i.useRef)(null),r=Object(l.d)(j);return Object(i.useImperativeHandle)(t,(function(){return n.current})),Object(i.useEffect)((function(){var e,t;r.playVideo?null===(e=n.current)||void 0===e||e.play():null===(t=n.current)||void 0===t||t.pause()}),[r.playVideo]),Object(g.jsx)("div",{children:Object(g.jsx)("video",{src:"./test.mp4",loop:!0,ref:n,style:{position:"absolute",zIndex:1,width:"100%",height:"100%"}})})})),k=function(e){var t=Object(i.useRef)(null),n=Object(i.useRef)(null),r=Object(l.d)(b),o=Object(l.e)(j),a=Object(i.useState)(!1),u=Object(d.a)(a,2),f=u[0],O=u[1];return Object(g.jsx)("div",{className:"canvas_app",style:{backgroundColor:"black",height:"100%"},children:f?Object(g.jsxs)(g.Fragment,{children:[Object(g.jsxs)("div",{children:[Object(g.jsx)(y,{ref:n}),Object(g.jsx)(E,{ref:t})]}),Object(g.jsx)("div",{style:{position:"relative",zIndex:3},children:r===c.INITIAL?Object(g.jsx)(p,{canvasRef:t,videoRef:n}):r===c.DRAW?Object(g.jsx)(x,{canvasRef:t}):r===c.TEXT?Object(g.jsx)(w,{canvasRef:t}):null})]}):Object(g.jsx)("button",{onClick:function(){return O(!0),o((function(e){return Object(s.a)(Object(s.a)({},e),{},{playVideo:!0})}))},children:"Start"})})};function S(){return Object(g.jsx)(l.a,{children:Object(g.jsx)(k,{})})}var P=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,226)).then((function(t){var n=t.getCLS,r=t.getFID,c=t.getFCP,i=t.getLCP,o=t.getTTFB;n(e),r(e),c(e),i(e),o(e)}))};u.a.render(Object(g.jsx)(o.a.StrictMode,{children:Object(g.jsx)(S,{})}),document.getElementById("root")),P()},96:function(e,t,n){}},[[222,1,2]]]);
//# sourceMappingURL=main.dc9256f8.chunk.js.map